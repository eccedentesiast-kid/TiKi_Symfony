{% extends 'base.html.twig' %}

{% block title %}{{ book.title }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link href="\asset\CSS\bookProfil.css" rel="stylesheet">
{% endblock %}

{% block body %}

    <div class="container">
        <div class="row flex-wrap-reverse flex-md-wrap">
            <div class="col-12 col-md-4">
                {% for image in book.images %}
                    {% if loop.first %}
                        <img id="main-image" class="img-thumbnail" src="{{ image.link }}">
                        <br>
                    {% endif %}
                    <img class="img-thumbnail img-small" src="{{ image.link }}" data-link="{{ image.link|raw }}"
                         onclick="selectImg(this)">
                    {% if loop.last %}
                    {% endif %}
                {% else %}
                    <b>There are no images</b>
                {% endfor %}
            </div>

            <div class="col-12 col-md-8">
                <h1>{{ book.title }} - {{ book.format }}</h1>
                <a href="#reviews"><h5>
                <span style="color:gold; font-size: 25px">
                {% set average_review = book.averageReview %}
                    {% for i in 1..5 %}
                        {{ i <= average_review ? "★" : "☆" }}
                    {% endfor %}
                </span> <span style="text-decoration: underline">{{ book.reviews|length }} Reviews</span></h5></a>
                <h3>Synopsis</h3>
                <p>{{ book.description }}</p>
                <h3>{{ book.price }}€</h3>
                <button type="button" class="btn btn-primary">Add to basket</button>
            </div>
        </div>
        <hr>
        <div id="reviews">
            <p class="d-inline-flex gap-1">
                <a class="btn btn-primary" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                    Write a review
                </a>
            </p>
            <div class="collapse" id="collapseExample">
                <div class="input-group mb-3">
                    <label for="customRange2" class="form-label">Give a rating from 1 to 5</label>
                    <input type="range" class="form-range" min="1" max="5" id="star">
                    <input id="reviewText" type="text" class="form-control" placeholder="Write your review" aria-label="Write your review">
                    <button class="btn btn-outline-secondary" type="button" onclick="submitReview(this)" id="postbutton">Post</button>
                </div>
            </div>
            <h1>Customer Reviews:</h1>
            {% for review in book.reviews %}
                {% if loop.first %}
                    <ul>
                {% endif %}
                <li>
                    <h5>{{ review.user.firstname }} {{ review.user.name }} - <span style="color:gold;">
                        {% for i in 1..5 %}
                            {{ i <= review.star ? "★" : "☆" }}
                        {% endfor %}
                    </span></h5>
                    <p>{{ review.text }}</p>
                </li>
                {% if not loop.last %}
                    <hr>
                {% else %}
                    </ul>
                {% endif %}
            {% else %}
                <b>There are no reviews</b>
            {% endfor %}
        </div>
        {% if( recommandations|length > 0 ) %}
            <hr>

            <h1>You may also like...</h1>
        <div class="row">
            {% for recommandation in recommandations %}
            <div class="col-sm-2 mb-3 mb-sm-0">

                <a href="/book/{{ recommandation.id }}">
                <div class="card" style="width: 18rem;">
                    <img src="{{ (recommandation.images|first).link }}" class="card-img-top" alt="...">
                    <div class="card-body">
                        <p class="card-text bold">{{ (recommandation.title) }}</p>
                    </div>
                </div>
                </a>
            </div>

            {% endfor %}
        </div>

        {% endif %}

    </div>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="\asset\JS\bookProfil.js"></script>

{% endblock %}


